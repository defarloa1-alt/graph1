// LCSH_Heading nodes from FederationSurvey
// Run via MCP run_cypher_mutation or: cypher-shell -f <file>

UNWIND [{lcsh_id: 'sh99005024', label: 'History', uri: 'https://id.loc.gov/authorities/subjects/sh99005024', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99005024', semantic_facet: 'INTELLECTUAL', temporal_start: null, temporal_end: null, survey_depth: 0, is_seed: false}, {lcsh_id: 'sh85115114', label: 'Rome--History--Republic, 510-30 B.C.', uri: 'https://id.loc.gov/authorities/subjects/sh85115114', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh85115114', semantic_facet: 'POLITICAL', temporal_start: -510, temporal_end: -30, survey_depth: 0, is_seed: true}, {lcsh_id: 'sh00005865', label: 'History, Naval', uri: 'https://id.loc.gov/authorities/subjects/sh00005865', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00005865', semantic_facet: 'MILITARY', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00006030', label: 'Historical geography', uri: 'https://id.loc.gov/authorities/subjects/sh00006030', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00006030', semantic_facet: 'GEOGRAPHIC', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00005861', label: 'History, Local', uri: 'https://id.loc.gov/authorities/subjects/sh00005861', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00005861', semantic_facet: 'GEOGRAPHIC', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh99004871', label: 'Criticism, interpretation, etc.--History', uri: 'https://id.loc.gov/authorities/subjects/sh99004871', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99004871', semantic_facet: 'INTELLECTUAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00006055', label: 'History of doctrines', uri: 'https://id.loc.gov/authorities/subjects/sh00006055', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00006055', semantic_facet: 'INTELLECTUAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh99005577', label: 'Criticism and interpretation--History', uri: 'https://id.loc.gov/authorities/subjects/sh99005577', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99005577', semantic_facet: 'INTELLECTUAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00005863', label: 'History, Military', uri: 'https://id.loc.gov/authorities/subjects/sh00005863', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00005863', semantic_facet: 'MILITARY', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh99005684', label: 'Doctrines--History', uri: 'https://id.loc.gov/authorities/subjects/sh99005684', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99005684', semantic_facet: 'INTELLECTUAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh99005617', label: 'Diplomatic history', uri: 'https://id.loc.gov/authorities/subjects/sh99005617', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99005617', semantic_facet: 'DIPLOMATIC', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh99005023', label: 'Church history', uri: 'https://id.loc.gov/authorities/subjects/sh99005023', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh99005023', semantic_facet: 'RELIGIOUS', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00006053', label: 'History of Biblical events', uri: 'https://id.loc.gov/authorities/subjects/sh00006053', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00006053', semantic_facet: 'RELIGIOUS', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh00006054', label: 'History of contemporary events', uri: 'https://id.loc.gov/authorities/subjects/sh00006054', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh00006054', semantic_facet: 'POLITICAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}, {lcsh_id: 'sh2002012516', label: 'Colonies--History', uri: 'https://id.loc.gov/authorities/subjects/sh2002012516', domain: 'roman_republic', concept_ref: 'https://id.loc.gov/authorities/subjects/sh2002012516', semantic_facet: 'POLITICAL', temporal_start: null, temporal_end: null, survey_depth: 1, is_seed: false}] AS row
MERGE (l:LCSH_Heading {lcsh_id: row.lcsh_id})
SET l.label = row.label, l.uri = row.uri, l.domain = row.domain,
    l.concept_ref = row.concept_ref, l.semantic_facet = row.semantic_facet,
    l.temporal_start = row.temporal_start, l.temporal_end = row.temporal_end,
    l.survey_depth = row.survey_depth, l.is_seed = row.is_seed;

UNWIND [{lcsh_id: 'sh99005024', facet_key: 'INTELLECTUAL'}, {lcsh_id: 'sh85115114', facet_key: 'POLITICAL'}, {lcsh_id: 'sh00005865', facet_key: 'MILITARY'}, {lcsh_id: 'sh00006030', facet_key: 'GEOGRAPHIC'}, {lcsh_id: 'sh00005861', facet_key: 'GEOGRAPHIC'}, {lcsh_id: 'sh99004871', facet_key: 'INTELLECTUAL'}, {lcsh_id: 'sh00006055', facet_key: 'INTELLECTUAL'}, {lcsh_id: 'sh99005577', facet_key: 'INTELLECTUAL'}, {lcsh_id: 'sh00005863', facet_key: 'MILITARY'}, {lcsh_id: 'sh99005684', facet_key: 'INTELLECTUAL'}, {lcsh_id: 'sh99005617', facet_key: 'DIPLOMATIC'}, {lcsh_id: 'sh99005023', facet_key: 'RELIGIOUS'}, {lcsh_id: 'sh00006053', facet_key: 'RELIGIOUS'}, {lcsh_id: 'sh00006054', facet_key: 'POLITICAL'}, {lcsh_id: 'sh2002012516', facet_key: 'POLITICAL'}] AS row
MATCH (l:LCSH_Heading {lcsh_id: row.lcsh_id})
MATCH (f:CanonicalFacet {key: row.facet_key})
MERGE (l)-[r:MAPS_TO_FACET]->(f)
SET r.weight = 1.0;
